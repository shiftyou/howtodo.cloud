---
layout: post
title:  "HelmÏúºÎ°ú mysql ÏÑ§ÏπòÌïòÍ∏∞"
categories: kubernetes
tags: helm
---
# Helm Ïù¥ÎûÄ.

Í∞úÎ∞úÍ≥º ÌÖåÏä§Ìä∏Ïùò ÌôòÍ≤ΩÏùÑ Íµ¨ÏÑ±ÌïòÎäî ÏãúÍ∞ÑÏùÑ Ï§ÑÏù¥Í≥† ÌîÑÎ°úÍ∑∏Îû®Ïóê Ï¢Ä Îçî ÏßëÏ§ëÌïòÍ∏∞ ÏúÑÌïòÏó¨ ÌïÑÏöîÌïú Í≤ÉÏù¥ Helm Ïù¥Îã§.   
node.jsÏùò npm Ïù¥ÎÇò Î¶¨ÎàÖÏä§Ïùò yum, apt Í∞ôÏùÄ Ïø†Î≤ÑÎÑ§Ìã∞Ïä§Ïùò Ìå®ÌÇ§ÏßÄ Î©îÎãàÏ†ÄÎùºÍ≥† Î≥¥Î©¥ ÎêúÎã§.  
Chart, Repository, ReleaseÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Î∞òÎ≥µÏ†ÅÏù∏ ÏùëÏö© ÌîÑÎ°úÍ∑∏Îû®Ïùò ÏÑ§Ïπò, Íµ¨ÏÑ± Î∞è Î≤ÑÏ†ºÍ¥ÄÎ¶¨ Î∞©Î≤ïÏùÑ Ï†úÍ≥µÌïúÎã§.

- Chart : Ïø†Î≤ÑÎÑ§Ìã∞Ïä§ ÌÅ¥Îü¨Ïä§ÌÑ∞ÏóêÏÑú Ïã§ÌñâÎêòÍ≥† Í≤ÄÏÉâ Í∞ÄÎä•Ìïú Î©îÌÉÄÎç∞Ïù¥ÌÑ∞Î°ú YAML ÌååÏùºÎ°ú Ï†ïÏùòÎêú Ïø†Î≤ÑÎÑ§ÏãúÌã∞ Î¶¨ÏÜåÏä§ Ìå®ÌÇ§ÏßÄ
- Repository : Í≤ÄÏÉâÍ∞ÄÎä•Ìïú Helm ChartÏùò Î¨∂Ïùå
- Release : Ïø†Î≤ÑÎÑ§Ìã∞Ïä§ ÌÅ¥Îü¨Ïä§ÌÑ∞Ïóê Î∞∞Ìè¨Îêú Helm Chart Ïù∏Ïä§ÌÑ¥Ïä§

ÏïÑÌÇ§ÌÖçÏ≤òÎäî ÎëêÍ∞ÄÏßÄÍ∞Ä Íµ¨ÏÑ±ÏöîÏÜåÎ°ú ÎêòÏñ¥ ÏûàÎã§.

![ÏïÑÌÇ§ÌÖçÏ≤ò](https://cdn.app.compendium.com/uploads/user/e7c690e8-6ff9-102a-ac6d-e4aebca50425/5a29c3c1-7c6b-41fa-8082-bdc8a36177c9/Image/c64c01d08df64f4420e81f962fd13a23/screen_shot_2018_09_11_at_4_48_19_pm.png)

- The Tiller Server: Ïø†Î≤ÑÎÑ§Ìã∞Ïä§ APIÏôÄ ÏÉÅÌò∏ ÏûëÏö©ÌïòÎäî Helm ÏÑúÎ≤Ñ
- The Helm Client : Ïª§Îß®Îìú ÎùºÏù∏ Helm ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏

# ÏÑ§Ïπò

## The Tiller Server 
Oracle Container Engine for Kubernetes (OKE) Î•º ÌÜµÌï¥ÏÑú Ïø†Î≤†ÎÑàÌã∞Ïä§ ÌÅ¥Îü¨Ïä§ÌÑ∞Î•º Quick CreateÎ°ú ÏÉùÏÑ±ÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú Helm TillerÎäî ÏÑ§ÏπòÎêúÎã§. 

## The Helm Client
ÏÑ§ÏπòÎäî Ïó¨Îü¨Í∞ÄÏßÄ Ìå®ÌÇ§ÏßÄ Îß§ÎãàÏ†ÄÎ°ú ÏÑ§ÏπòÌï† Ïàò ÏûàÎã§.
- [Homebrew](https://brew.sh/) : brew install kubernetes-helm.
- [Chocolatey](https://chocolatey.org/) : choco install kubernetes-helm.
- [Scoop](https://scoop.sh/) : scoop install helm.
- [GoFish](https://gofi.sh/) : gofish install helm.


brew Î°ú ÏÑ§ÏπòÎ•º ÌïòÎ©¥ Îã§ÏùåÍ≥º Í∞ôÎã§.
~~~sh
$ brew install kubernetes-helm

Updating Homebrew...
==> Auto-updated Homebrew!
Updated 1 tap (homebrew/core).
==> Downloading https://homebrew.bintray.com/bottles/kubernetes-helm-2.13.1.moja
==> Downloading from https://akamai.bintray.com/30/30f412ad5b85b63edbd373cfca01f
######################################################################## 100.0%
==> Pouring kubernetes-helm-2.13.1.mojave.bottle.tar.gz
==> Caveats
Bash completion has been installed to:
  /usr/local/etc/bash_completion.d

zsh completions have been installed to:
  /usr/local/share/zsh/site-functions
==> Summary
üç∫  /usr/local/Cellar/kubernetes-helm/2.13.1: 51 files, 84.2MB
==> `brew cleanup` has not been run in 30 days, running now...
$
 ~~~

# Ï¥àÍ∏∞Ìôî

Helm Ïù¥ Ï§ÄÎπÑÎêòÏóàÏúºÎãà, Ï¥àÍ∏∞ÌôîÎ•º ÌïúÎã§.
~~~
$ helm init --history-max 200

$HELM_HOME has been configured at /Users/jonggyou/.helm.
Warning: Tiller is already installed in the cluster.
(Use --client-only to suppress this message, or --upgrade to upgrade Tiller to the current version.)
Happy Helming!
~~~

ÏúÑÏùò Î™ÖÎ†πÏñ¥Îäî ÏõêÎûò Ïø†Î≤ÑÎÑ§Ìã∞Ïä§ ÌÅ¥Îü¨Ïä§ÌÑ∞Ïùò `kubectl config current-context`Ïóê tillerÎ•º ÏÑ§ÏπòÌïòÎäî Í≤ÉÏù¥ÎÇò, OKEÏóêÏÑúÎäî Ïù¥ÎØ∏ ÏÑ§ÏπòÍ∞Ä ÎêòÏñ¥ ÏûàÏñ¥ÏÑú Ïù¥ÎØ∏ ÏÑ§ÏπòÍ∞Ä ÎêòÏñ¥ ÏûàÎã§Í≥† ÏïåÎ†§Ï§ÄÎã§.

TillerÎ•º ÏóÖÍ∑∏Î†àÏù¥Îìú ÌïòÎ†§Î©¥ Îã§ÏùåÍ≥º Í∞ôÏù¥ Î™ÖÎ†πÌïúÎã§.
~~~
$ helm init --upgrade

$HELM_HOME has been configured at /Users/jonggyou/.helm.

Tiller (the Helm server-side component) has been upgraded to the current version.
Happy Helming!
~~~

helmÏùò chartÎ•º ÏµúÏã† Î¶¨Ïä§Ìä∏Î°ú ÏóÖÎç∞Ïù¥Ìä∏ ÌïúÎã§.
~~~
$ helm repo update

Hang tight while we grab the latest from your chart repositories...
...Skip local chart repository
...Successfully got an update from the "stable" chart repository
Update Complete. ‚éà Happy Helming!‚éà
~~~

Ïñ¥Îñ§ ÏÜîÎ£®ÏÖòÏùÑ ÏÑ§ÏπòÌï† Ïàò ÏûàÎäîÏßÄÎäî search Î™ÖÎ†πÏñ¥Î°ú Ïïå Ïàò ÏûàÎã§.
~~~
$ helm search mysql

NAME                            	CHART VERSION	APP VERSION	DESCRIPTION
stable/mysql                    	0.15.0       	5.7.14     	Fast, reliable, scalable, and easy to use open-source rel...
stable/mysqldump                	2.4.0        	2.4.0      	A Helm chart to help backup MySQL databases using mysqldump
stable/prometheus-mysql-exporter	0.3.2        	v0.11.0    	A Helm chart for prometheus mysql exporter with cloudsqlp...
stable/percona                  	0.3.4        	5.7.17     	free, fully compatible, enhanced, open source drop-in rep...
stable/percona-xtradb-cluster   	0.6.6        	5.7.19     	free, fully compatible, enhanced, open source drop-in rep...
stable/phpmyadmin               	2.2.0        	4.8.5      	phpMyAdmin is an mysql administration frontend
stable/gcloud-sqlproxy          	0.6.1        	1.11       	DEPRECATED Google Cloud SQL Proxy
stable/mariadb                  	5.11.1       	10.1.38    	Fast, reliable, scalable, and easy to use open-source rel...

$ helm search tomcat

NAME         	CHART VERSION	APP VERSION	DESCRIPTION
stable/tomcat	0.2.0        	7          	Deploy a basic tomcat application server with sidecar as ...

$ helm search apache

NAME                	CHART VERSION	APP VERSION	DESCRIPTION
stable/hadoop       	1.1.0        	2.9.0      	The Apache Hadoop software library is a framework that al...
stable/ignite       	1.0.0        	2.7.0      	Apache Ignite is an open-source distributed database, cac...
stable/jenkins      	0.37.3       	lts        	Open source continuous integration server. It supports mu...
stable/kafka-manager	1.1.2        	1.3.3.22   	A tool for managing Apache Kafka.
stable/superset     	1.1.5        	0.28.1     	Apache Superset (incubating) is a modern, enterprise-read...
~~~

# ÏÑ§Ïπò

mysqlÏùÑ ÏÑ§ÏπòÌï¥ Î≥¥ÎèÑÎ°ù ÌïúÎã§.
~~~
$ helm install stable/mysql

NAME:   luminous-jellyfish
LAST DEPLOYED: Mon Apr 15 16:37:11 2019
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==> v1/ConfigMap
NAME                           DATA  AGE
luminous-jellyfish-mysql-test  1     5s

==> v1/PersistentVolumeClaim
NAME                      STATUS   VOLUME  CAPACITY  ACCESS MODES  STORAGECLASS  AGE
luminous-jellyfish-mysql  Pending  oci     4s

==> v1/Pod(related)
NAME                                       READY  STATUS   RESTARTS  AGE
luminous-jellyfish-mysql-689db84657-hdztl  0/1    Pending  0         3s

==> v1/Secret
NAME                      TYPE    DATA  AGE
luminous-jellyfish-mysql  Opaque  2     5s

==> v1/Service
NAME                      TYPE       CLUSTER-IP     EXTERNAL-IP  PORT(S)   AGE
luminous-jellyfish-mysql  ClusterIP  10.96.129.127  <none>       3306/TCP  4s

==> v1beta1/Deployment
NAME                      READY  UP-TO-DATE  AVAILABLE  AGE
luminous-jellyfish-mysql  0/1    1           0          3s


NOTES:
MySQL can be accessed via port 3306 on the following DNS name from within your cluster:
luminous-jellyfish-mysql.default.svc.cluster.local

To get your root password run:

    MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default luminous-jellyfish-mysql -o jsonpath="{.data.mysql-root-password}" | base64 --decode; echo)

To connect to your database:

1. Run an Ubuntu pod that you can use as a client:

    kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il

2. Install the mysql client:

    $ apt-get update && apt-get install mysql-client -y

3. Connect using the mysql cli, then provide your password:
    $ mysql -h luminous-jellyfish-mysql -p

To connect to your database directly from outside the K8s cluster:
    MYSQL_HOST=127.0.0.1
    MYSQL_PORT=3306

    # Execute the following command to route the connection:
    kubectl port-forward svc/luminous-jellyfish-mysql 3306

    mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD}
~~~

ÌòÑÏû¨ helmÏúºÎ°ú Î∞∞Ìè¨ÎêòÏñ¥ ÏûàÎäî Ìï≠Î™©ÏùÑ Î≥¥Î©¥ Îã§ÏùåÍ≥º Í∞ôÎã§.
~~~
$ helm ls

helm list
NAME              	REVISION	UPDATED                 	STATUS  	CHART       	APP VERSION	NAMESPACE
luminous-jellyfish	1       	Mon Apr 15 16:37:11 2019	DEPLOYED	mysql-0.15.0	5.7.14     	default
my-release        	1       	Fri Mar 15 11:21:11 2019	DEPLOYED	fn-0.1.0    	0.0.161    	default
~~~


---
Ï∞∏Í≥† :  
- [Take the Helm: Kubernetes Package Management](https://blogs.oracle.com/cloudnative/helm-kubernetes-package-management)
- [Creating a Cluster with Oracle Cloud Infrastructure Container Engine for Kubernetes](https://www.oracle.com/webfolder/technetwork/tutorials/obe/oci/oke-full/index.html)
- [Helm for Git](https://github.com/helm/helm)
- [Helm Quickstart Guide](https://helm.sh/docs/using_helm/#quickstart-guide)
